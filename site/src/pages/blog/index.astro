---
import Layout from "../../layouts/Layout.astro";
import { getCollection } from "astro:content";

const posts = (await getCollection("blog"))
	.filter((post) => !post.data.draft)
	.sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());

const formatter = new Intl.DateTimeFormat("en-US", {
	year: "numeric",
	month: "short",
	day: "numeric",
});
---

<Layout title="Blog â€” Guy Abi Hanna" description="Writing and notes">
	<h1>Blog</h1>
	<p class="small">Short, high-signal notes on AI engineering, agents, and building.</p>

	{posts.length === 0 ? (
		<p class="small">No posts yet.</p>
	) : (
		<div class="list">
			{posts.map((post) => {
				const tags = post.data.tags ?? [];
				const icon = tags.includes("voice")
					? "ğŸ™"
					: tags.includes("systems")
						? "ğŸ§°"
						: tags.includes("product")
							? "ğŸ§±"
							: tags.includes("craft")
								? "âœï¸"
								: "â†’";

				return (
					<article class="list-item">
						<a class="title" href={`/blog/${post.slug}`}>
							<span aria-hidden="true">{icon}</span> {post.data.title}
						</a>
						<div class="meta">
							{formatter.format(post.data.pubDate)}
							{tags.length ? ` Â· ${tags.join(" / ")}` : ""}
						</div>
						<p class="small">{post.data.description}</p>
					</article>
				);
			})}
		</div>
	)}
</Layout>
